# Device Finder

Это простое приложение для поиска сетевых устройств по шаблону MAC-адреса. Состоит из
утилиты командной строки и графического интерфейса на Tkinter.

## Требования

- Python 3.8+
- Библиотека `scapy`

Установить зависимости можно командой:

```bash
pip install -r requirements.txt
```

## Командная утилита

```
python find_devices.py --network 192.168.1.0/24 --mac-prefix 00:11:22
```

Сканирует указанный диапазон и выводит найденные IP-адреса, MAC-адреса и имя хоста
("unknown", если определить его не удалось), соответствующие заданному префиксу.
Получение имени сначала пробует NetBIOS-запрос Node Status, затем обратное DNS.

## Графический интерфейс

```
python find_devices_gui.py
```

Запускает простое окно, в котором можно задать подсеть и MAC-префикс,
а затем выполнить поиск устройств. В результатах также отображается имя хоста ("unknown", если его нет).
Имя определяется аналогично: сначала через NetBIOS, затем через DNS.

## Teltonika API Client

Файл `teltonika_api.py` реализует работу с HTTP API роутеров Teltonika. Сначала
производится авторизация запросом `POST /api/login`, после чего полученный токен
используется в заголовке `Authorization` для всех последующих обращений.

Пример чтения конфигурации:

```bash
python teltonika_api.py 192.168.1.1 admin admin GET /wireguard/config
```

Для `POST` и `PUT` запросов можно передать данные через `--data`.
Строка с JSON может содержать лишние завершающие запятые,
одинарные кавычки или быть заключена в дополнительные кавычки –
клиент постарается исправить такие опечатки
и даже использует `ast.literal_eval` для разбора
Python‑подобных структур. Обработчик гарантирует отправку корректного
JSON; если разобрать данные не удаётся, они будут отправлены как есть:

```bash
python teltonika_api.py 192.168.1.1 admin admin POST /wireguard/config --data '{"data": {"id": "example"}}'
```
Если команда выполняется в Windows `cmd`, используйте двойные кавычки вокруг
JSON или экранируйте одинарные. Клиент также удаляет внешние кавычки из
переданной строки, чтобы избежать ошибки "No arguments provided" при отправке.

При необходимости можно использовать HTTPS и отключить проверку сертификата:

```bash
python teltonika_api.py 192.168.1.1 admin admin GET /wireguard/config --https --no-verify
```

Перед авторизацией утилита проверяет доступность хоста.
Если устройство использует самоподписанный сертификат, клиент
автоматически повторит попытку авторизации с отключенной проверкой.
Флаг `--no-verify` позволяет сразу отключить проверку сертификата.

Ответ выводится как текст или JSON.

## Teltonika API GUI

```bash
python teltonika_api_gui.py
```

Откроет окно, в котором можно указать IP‑адрес, логин и пароль. Сначала
нужно нажать кнопку **Login** для получения токена. Под полем авторизации
отображается текущий токен, полученный от устройства. Перед авторизацией
проверяется корректность введённого IPv4‑адреса и доступность устройства.
После успешной авторизации становятся доступны запросы (GET, POST, PUT, DELETE)
к эндпоинтам API. Поле "Payload" принимает JSON‑строку для POST/PUT.
Лишние завершающие запятые и одинарные кавычки в вводе автоматически исправляются; если
строку всё равно не удаётся разобрать, она отправляется без изменений.
При необходимости можно использовать HTTPS и отключить проверку
сертификата (соответствующие галочки в окне). Поле пароля имеет галочку
"Show password" для отображения введённого текста. Ответы выводятся в двух
полях: исходный текст и форматированное представление. При активной опции
**Highlight JSON** ключи выделяются коричневым, строковые значения –
зелёным, числа – синим, булевы значения – фиолетовым. При отключении
подсветки текст становится чёрным. Приложение
написано на `tkinter` и может быть запущено под Windows.

Окно интерфейса можно свободно изменять по размеру. Высота областей
"Raw response" и "Readable response" распределена в пропорции 1:3,
поэтому форматированный текст занимает больше места. При изменении
размера окна эти поля растягиваются, занимая доступное пространство.
Если при авторизации возникает ошибка SSL, клиент
автоматически пробует повторно без проверки сертификата.
В этом случае галочка **Verify SSL** будет снята, чтобы последующие
запросы выполнялись без проверки.

Выпадающие списки IP‑адресов и путей запоминают последние введённые
значения (до пяти штук). История хранится в файле `history.json` в каталоге
приложения и подгружается при запуске, чтобы не вводить часто используемые
адреса и пути заново.
